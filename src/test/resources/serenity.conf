# Configuración del Navegador
webdriver {
  capabilities {
    browserName = "chrome"
    "goog:chromeOptions" {
      # QUITAMOS "headless" de esta lista para poder ver el navegador
      args = ["test-type", "no-sandbox", "ignore-certificate-errors", "--window-size=390,844", "incognito", "disable-gpu", "disable-infobars", "disable-dev-shm-usage", "disable-extensions"]
    }
  }
}

headless.mode = false

# Entornos (Aquí definimos la URL base)
environments {
  default {
    webdriver.base.url = "https://credgruppro.web.app/"
  }
}

serenity.fail.on.pending.steps = true

# Configuraciones de Chrome (Para evitar errores comunes)
chrome.switches = """--window-size=550,1020; --test-type; --no-sandbox; --ignore-certificate-errors;
                   --disable-popup-blocking; --disable-default-apps; --disable-extensions-file-access-check;
                   --incognito; --disable-infobars; --disable-gpu"""

serenity {
    # Toma la foto al final de cada paso
    take.screenshots = AFTER_EACH_STEP
    
    # REFUERZO GLOBAL:
    # Le dice a Serenity que espere a que no haya actividad en el navegador 
    # antes de disparar la foto.
    wait.for.screenshot.until.met = true
    
    # Tiempo máximo que esperará para que la página se estabilice (en ms)
    # 500ms es el "punto dulce" para no ralentizar los tests pero asegurar la foto.
    screenshot.patience = 500
}

